% LaTeX translation of Typst source for NeuFACO
\documentclass[a4paper,conference]{IEEEtran}
\pdfminorversion=6
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
% \usepackage{lmodern}
% \usepackage{geometry}
% \usepackage{booktabs}
\usepackage{amsmath,amssymb,amsfonts}
\usepackage{graphicx}
\usepackage{booktabs}
\usepackage{url}
\usepackage{hyperref}
\usepackage{cite}
\usepackage{float}
\usepackage{caption}
\usepackage{subcaption}
\usepackage{microtype}
\usepackage{siunitx}
\usepackage{courier}
\usepackage{tikz}

% Short macros
\newcommand{\calN}{\mathcal{N}}
\newcommand{\calC}{\mathcal{C}}
\newcommand{\calH}{\mathcal{H}}
\newcommand{\RR}{\mathbb{R}}
\newcommand{\eps}{\varepsilon}

\title{Neural Focused Ant Colony Optimization for Traveling Salesman Problem}
\IEEEoverridecommandlockouts
\author{%
  \IEEEauthorblockN{ 
    Tran Thanh Dat\IEEEauthorrefmark{1}\IEEEauthorrefmark{3}, 
    Pham Anh Khoi\IEEEauthorrefmark{2}\textsuperscript{1},
    Tran Quang Khai\IEEEauthorrefmark{1}\textsuperscript{1},
    Do Duc Dong\IEEEauthorrefmark{3}\textsuperscript{2},
    and Vu Van Khu\IEEEauthorrefmark{1}\textsuperscript{2}}
  \IEEEauthorblockA{\IEEEauthorrefmark{1}%
                    College of Engineering and Computer Science, VinUniversity, Hanoi, Vietnam\\
                    \IEEEauthorrefmark{2}%
                    School of Information and Communications Technology, Hanoi University of Science and Technology, Hanoi, Vietnam\\
                    \IEEEauthorrefmark{3}%
                    University of Engineering and Technology, Vietnam National University, Hanoi, Vietnam\\
                    }                
  \IEEEauthorblockA{\IEEEauthorrefmark{1}\{dat.tt3,23khai.tq,khu.vv\}@vinuni.edu.vn \quad
                     \IEEEauthorrefmark{2}khoi.pa230043@sis.hust.edu.vn \quad
                     \IEEEauthorrefmark{3}dongdoduc@vnu.edu.vn
                     }
                     \thanks{\textsuperscript{1}Equal contribution.}
                     \thanks{\textsuperscript{2}Corresponding authors.}
}

\renewcommand{\footnoterule}{%
  \vspace*{-0.8em}% space above
  \hrule width 0.4\columnwidth % rule length
  \vspace*{0.6em}% space below
}
\begin{document}

\maketitle

\begin{abstract}
This study introduces Neural Focused Ant Colony Optimization (NeuFACO), a non-autoregressive framework designed to address the Traveling Salesman Problem (TSP) by integrating advanced reinforcement learning methods with enhanced Ant Colony Optimization (ACO) techniques. Unlike prior neural-augmented ACO methods that rely on simplistic training schemes, NeuFACO adapts Proximal Policy Optimization (PPO) to train a graph neural network for generating instance-specific heuristic guidance. This learned heuristic is integrated into a highly optimized ACO framework that incorporates several state-of-the-art enhancements—such as candidate lists, focused tour modification, and scalable local search. By jointly exploiting amortized inference and the parallel stochastic exploration characteristic of ACO, NeuFACO delivers efficient and high-quality solutions over a diverse set of TSP instances.
\end{abstract}

\begin{IEEEkeywords}
Ant Colony Optimization, Traveling Salesman Problem, Proximal Policy Optimization, Graph Neural Networks, Neural Combinatorial Optimization
\end{IEEEkeywords}

\section{Introduction}
The Traveling Salesman Problem (TSP) is a classical combinatorial optimization problem (COP) that seeks the shortest Hamiltonian tour visiting each city once and returning to the start. Due to its relevance in logistics, production planning, and circuit design, it serves as a benchmark for evaluating optimization algorithms \cite{Applications}.

Exact approaches like integer linear programming guarantee optimality but scale poorly due to exponential complexity \cite{LP}. Heuristic and metaheuristic methods offer efficient near-optimal solutions but often lack problem-specific knowledge, rely on handcrafted heuristics, and risk premature convergence to local optima \cite{TSP2,Nature-inspired}.

Deep learning has inspired data-driven approaches to COPs such as TSP \cite{MLCO}. Supervised methods train neural networks to imitate solvers for fast inference but depend on labeled solutions, limiting generalization. Reinforcement learning (RL) avoids this by directly optimizing solution quality through interaction, yet RL-based methods still suffer from weak local refinement, poor scalability, and high sample complexity \cite{NCO}.

To address these issues, hybrid frameworks combine neural models with metaheuristics. Non-autoregressive (NAR) “learn-to-predict” methods use neural networks to generate heuristics that guide metaheuristics, rather than directly constructing solutions \cite{DeepACO,RL4CO}. However, current approaches face high variance and low sample efficiency due to simplistic training, while refinement often relies on standard Ant Colony Optimization (ACO) \cite{ACO3}, which exploits TSP structure inefficiently and limits scalability to larger or heterogeneous instances.

\subsection{Paper overview}
We introduce Neural Focused Ant Colony Optimization (NeuFACO), a hybrid framework that integrates deep reinforcement learning with a refined variant of ACO. NeuFACO employs Proximal Policy Optimization (PPO) \cite{PPO} to train a neural policy, offering greater stability and sample efficiency than prior approaches.

For refinement, NeuFACO adapts Focused ACO (FACO) \cite{FACO2022}, an advanced extension that performs targeted modifications around a reference solution. Unlike conventional ACO, which rebuilds full tours each iteration, FACO selectively relocates a few nodes, preserving strong substructures while improving weaker regions. This focused search narrows exploration to promising areas, enhancing efficiency.

By combining neural priors with adaptive refinement, NeuFACO balances global guidance and local exploitation. This reduces disruption to near-optimal tours, accelerates convergence, and scales effectively to large TSP instances.

Experiments show that NeuFACO outperforms neural and classical baselines on random TSPs and TSPLIB benchmarks, solving problems with up to 1,500 nodes. Results also confirm the advantage of PPO in producing high-quality heuristic priors, establishing NeuFACO as a robust and generalizable framework for neural-augmented combinatorial optimization.

\section{Related Work}\label{sec:methods}
\subsection{Traveling Salesman Problem}
The Traveling Salesman Problem (TSP) is a classical NP-hard problem in combinatorial optimization \cite{TSP1,TSP3}. It can be formally defined on a complete graph $G=(V,E)$, where the vertex set $V=\{v_1,v_2,\dots,v_n\}$ corresponds to the $n$ cities and the edge set $E$ denotes all pairwise connections among them. Each edge $(i,j)\in E$ has an associated non-negative cost $d_{i,j}$, often representing distance or travel time. For simplicity, this paper focuses on the two-dimensional Euclidean TSP as an illustrative example, where each edge $(i,j)\in E$ has a distance feature:
\begin{equation}
d_{ij} = \|v_i - v_j\|.
\end{equation}
The task is to determine a Hamiltonian tour $\pi = (\pi_1, \pi_2, \dots, \pi_n)$ that traverses every city once before returning to the origin, with the goal of minimizing the aggregate travel distance or cost:
\begin{equation}
C(\pi) = \sum_{i=1}^n d_{\pi_i,\pi_{i+1}},
\end{equation}
where $\pi$ is a permutation of $V$ representing the visiting order of the cities and $\pi_{n+1}=\pi_1$.

\subsection{Classical Methods}
Classical approaches to the TSP fall into two categories: exact and heuristic-based \cite{TSP2}. Exact methods—such as branch-and-bound \cite{branch} and Integer Linear Programming \cite{LP}—guarantee optimality but suffer factorial time complexity, making them impractical for large instances.

To improve scalability, heuristic and metaheuristic algorithms provide near-optimal solutions in reasonable time \cite{MetaHeuristic}. Local search methods like 2-opt, 3-opt, and Lin–Kernighan \cite{twoopt,LKH} refine tours by replacing subpaths to reduce cost, while metaheuristics such as Ant Colony Optimization \cite{ACO2} and Genetic Algorithms \cite{GA} stochastically explore the solution space by simulating natural processes.

\subsection{Ant Colony Optimization}

Ant Colony Optimization is a bio-inspired metaheuristic that emulates the collective foraging behavior of natural ant colonies \cite{ACO}. In the context of the TSP, artificial ants construct solutions by probabilistically choosing the next city according to two key factors: the pheromone trail $\tau_{ij}$, which encodes the learned desirability of selecting edge $(i,j)$, and the heuristic desirability $\eta_{ij}=1/d_{ij}$, which favors shorter edges. The probability $p_{ij}^k$ that ant $k$ moves from city $i$ to city $j$ is typically defined as
\begin{equation}
 p_{ij}^k = \begin{cases}
 \dfrac{\tau_{ij}^\alpha \eta_{ij}^\beta}{\sum_{l\in\calN_i^k} \tau_{il}^\alpha \eta_{il}^\beta} & \text{if } j\in\calN_i^k, \\
 0 & \text{otherwise,}
 \end{cases}
\end{equation}
where $\calN_i^k$ denotes the set of cities not yet visited by ant $k$, and $\alpha$ and $\beta$ determine the relative weighting of pheromone intensity and heuristic desirability. Once all ants have completed their tours, pheromone trails are updated both to reinforce high-quality paths and to allow for evaporation, which encourages exploration:
\begin{equation}
\tau_{ij} \leftarrow (1-\rho)\tau_{ij} + \sum_{k=1}^m \Delta\tau_{ij}^k,
\end{equation}
where $\rho\in(0,1]$ is the evaporation rate, and $\Delta\tau_{ij}^k$ represents the pheromone deposited by ant $k$ proportional to the quality of its solution. Over time, ACO converges toward promising regions of the solution space, but it may encounter slow convergence or premature stagnation.

\begin{figure}[!tb]
  \centering
  \includegraphics[width=\linewidth]{ACO.pdf}
  \caption{Original Ant Colony Optimization.}
  \label{fig:ACO}
\end{figure}

\subsection{Neural Combinatorial Optimization}
Neural Combinatorial Optimization (NCO) employs deep learning to derive heuristics for NP-hard problems such as the Traveling Salesman Problem (TSP) \cite{MLCO}. Unlike handcrafted approaches, NCO learns directly from data via supervised imitation of high-quality solutions or reinforcement learning on reward signals such as negative tour length. Architectures explored include pointer networks \cite{pointernetwork}, GNNs \cite{gnn}, and more recently Transformers \cite{transformer} and diffusion models \cite{difusco}.

NCO methods are generally categorized as constructive, incrementally generating solutions, or improvement-based, refining initial ones with techniques like 2-opt \cite{NCO}. Non-autoregressive (NAR) variants follow a hybrid paradigm: neural encoders extract heuristic signals that metaheuristics exploit for solution construction, contrasting with end-to-end autoregressive models \cite{RL4CO}.

In Ant Colony Optimization (ACO), classical heuristics are handcrafted and domain-dependent, limiting scalability and adaptability. NAR methods overcome these issues by learning heuristics from data and embedding them into the ACO pipeline. Early implementations relied on REINFORCE \cite{REINFORCE}, but its high variance and slow convergence hindered performance, motivating more stable reinforcement learning techniques.

\begin{figure}[!tb]
  \centering
  \includegraphics[width=\linewidth]{DACO.pdf}
  \caption{NAR training procedure.}
  \label{fig:DACO}
\end{figure}

\section{Methodology}
\subsection{Training method}
\subsubsection{Markov Decision Process (MDP) formulation}
We formulate the solution construction procedure of TSP as a Markov Decision Process (MDP). Each state $s_t\in\mathcal{S}$ represents a partial solution after $t$ steps of construction. The entire state space is defined over a set of discrete decision variables $\{X_1,\dots,X_n\}$ with domains $D_i$, and constraints define which combinations are valid.

\subsubsection{Neural Heuristic Formulation}
A graph neural network $f_{\theta}$ parameterized by $\theta$ takes the graph data $\mathcal{X}$ as input and outputs:
\begin{itemize}
  \item Heuristic matrix $H\in\RR^{n\times n}$ representing a learned prior over edge transitions.
  \item Value prediction $  V_{\theta}(\mathcal{X})\in\RR$ estimating expected return for the given instance.
\end{itemize}

\subsection{Ant Colony Optimization with Neural Guidance}
The ACO constructs a probability distribution over transitions:
\begin{equation}
p_{ij} \propto \tau_{ij}^\alpha \cdot H_{ij},
\end{equation}
where $\tau_{ij}$ is the pheromone and $H_{ij}$ is the learned heuristic, and $\alpha$ is a weighting parameter. Each of the $M$ ants sample a tour $\pi^{(m)}$ with cost $C(\pi^{(m)})$. The corresponding reward is defined as $R^{(m)} = -C(\pi^{(m)})$, which is then normalized using baseline subtraction:
\begin{equation}
\hat{R}^{(m)} = R^{(m)} - \frac{1}{M}\sum_{m=1}^M R^{(m)}.
\end{equation}

\subsection{Advantage Estimation}
The baseline value is expanded to all ants: $V^{(m)} = v, \forall m=1,\dots,M$. The advantage is then:
\begin{equation}
A^{(m)} = \hat{R}^{(m)} - V^{(m)}.
\end{equation}

\subsection{Proximal Policy Optimization Objective}
For each sampled path $\pi^{(m)}$, let $\log p_{\theta}(\pi^{(m)})$ denote the log probability of sampling under the current policy, and $\log p_{\theta_{\text{old}}}(\pi^{(m)})$ under the previous policy. The probability ratio is:
\begin{equation}
r^{(m)}(\theta) = \frac{p_{\theta}(\pi^{(m)})}{p_{\theta_{\text{old}}}(\pi^{(m)})}.
\end{equation}
The clipped PPO surrogate objective is:
\begin{equation}
\begin{aligned}
\mathcal{L}_{\text{policy}}(\theta) = -\frac{1}{M}\sum_{m=1}^M \min\big(&r^{(m)}A^{(m)}, \\
&\text{clip}(r^{(m)},1-\eps,1+\eps)A^{(m)}\big).
\end{aligned}
\end{equation}

\subsection{Value Function Loss}
The value network is trained with mean squared error (MSE):
\begin{equation}
\mathcal{L}_{\text{value}}(\theta) = \frac{1}{M}\sum_{m=1}^M (V^{(m)} - \hat{R}^{(m)})^2.
\end{equation}

\subsection{Entropy Regularization}
To promote exploration, entropy is computed on the normalized heuristic distribution: $\tilde{H}_{ij} = H_{ij} / (\sum_k H_{ik})$ and
\begin{equation}
\calH(\tilde{H}) = -\frac{1}n \sum_{i=1}^n\sum_{j=1}^n \tilde{H}_{ij}\log(\tilde{H}_{ij}+\eps).
\end{equation}
The entropy loss is:
\begin{equation}
\mathcal{L}_{\text{entropy}} = -\beta\calH(\tilde{H}),
\end{equation}
with entropy coefficient $\beta>0$.

\subsection{Final Training Objective}
The overall training loss combines the three components:
\begin{equation}
\mathcal{L}(\theta) = \mathcal{L}_{\text{policy}} + \mathcal{L}_{\text{value}} + \mathcal{L}_{\text{entropy}}.
\end{equation}

\section{Solution sampling}
Our method incorporates multiple state-of-the-art enhancements aimed at improving both the computational efficiency and solution quality of ACO algorithms. These improvements address three key aspects of solution construction: efficient node selection, focused modifications to high-quality tours, and scalable local search. Figure~\ref{fig:FACO} demonstrates the final algorithm for solution sampling.

\subsection{Incorporating the Min--Max Ant System}
To enhance solution quality and stabilize the search process, NeuFACO adopts the Min--Max Ant System (MMAS) \cite{MMAS} for pheromone updates. MMAS modifies the classical Ant System in two key aspects: (1) pheromone trails are restricted to the interval $[\tau_{\min},\tau_{\max}]$ to prevent premature convergence, and (2) updates rely solely on the best-so-far or iteration-best solution, rather than aggregating contributions from all ants.

In our implementation, pheromone updates follow the standard MMAS rule:
\begin{equation}
\tau_{ij} \leftarrow \begin{cases}
(1-\rho)\tau_{ij} + \Delta\tau_{ij}^{\text{best}} & \text{if edge }(i,j) \text{ chosen},\\
(1-\rho)\tau_{ij} & \text{otherwise},
\end{cases}
\end{equation}
\begin{equation}
\tau_{ij} \leftarrow \operatorname{clamp}(\tau_{ij},\tau_{\min},\tau_{\max}).
\end{equation}

This mechanism is particularly critical when combined with neural-guided heuristics, as it prevents the learned model from prematurely dominating the search dynamics.

\begin{figure}[!htb]
  \centering
  \includegraphics[width=\linewidth]{FACO.pdf}
  \caption{State-of-the-art Ant Colony Optimization.}
  \label{fig:FACO}
\end{figure}

\subsection{Node Selection via Candidate and Backup Lists}
Candidate lists are widely used in ACO to restrict node selection to the $k$-nearest neighbors, thereby reducing complexity. Formally, for current node $i$, the candidate set is
\begin{equation}
\calC_i = \{u_{i,j} \mid j\le k,\; \texttt{visited}(u_{i,j})=0\}.
\end{equation}

When $\calC_i=\varnothing$, classical ACO scans all unvisited nodes, an $O(n)$ operation. To avoid this, we adopt the backup strategy of \cite{ACOTSP-MF}: each node maintains a precomputed backup list $\text{BKP}_i$, from which the first unvisited neighbor is selected. Only if both $\calC_i$ and $\text{BKP}_i$ are empty do we fall back to
\begin{equation}
J = \arg\min_{u:\texttt{visited}(u)=0} d(i,u).
\end{equation}

This hierarchical rule preserves stochastic exploration early on while substantially reducing overhead in the later stages of tour construction.

\subsection{Node Relocation to maintain path structure}
We adopt the focused modification strategy introduced in \cite{FACO2023}, which aims to explore the solution space by making minimal impactful changes to existing high-quality tours. At the start of construction, each ant stochastically copies a complete tour from either the iteration-best or the global-best candidate and subsequently modifies it by introducing new nodes based on the standard transition rule.

From the selected edge $(u,v)$ and the original tour $\pi$, a relocate move produces a new tour $\pi'$ by removing $v$ from its current position and reinserting it immediately after $u$. Let $p=\operatorname{pred}(v)$ be the predecessor of $v$ in $\pi$, $s=\operatorname{succ}(v)$ be the successor of $v$, and $s_u$ be the successor of $u$. Then the cost change from performing such a move is
\begin{equation}
\Delta C = -d_{p,v} - d_{v,s} - d_{u,s_u} + d_{p,u} + d_{u,v} + d_{v,s_u}.
\end{equation}

To maintain structural similarity to the reference tour, modification is limited: once a predefined minimum number of new edges (MNE) is introduced (we set \texttt{MNE}=8), the ant stops altering the route and continues following the remaining portion of the original tour. This strategy restricts the number of relocated nodes, thereby concentrating the search effort on promising subregions of the solution space while avoiding the computational burden of constructing tours entirely from scratch. Figure \ref{fig:perm-swap} demonstrates an example of a node relocation operation.

\begin{figure}[ht]
    \centering
    \resizebox{0.85\linewidth}{!}{%


\usetikzlibrary{arrows.meta, positioning, calc}
\begin{tikzpicture}[every node/.style={circle, draw}, node distance=0.5cm, scale=1, transform shape]

% Top Graph
\node (a1) at (0,0) {a};
\node (c1) at (2,0) {c};
\node (b1) at (3.5,1.5) {b};
\node (d1) at (4.5,0) {d};
\node (e1) at (6,1.5) {e};

\draw (a1) -- (b1);
\draw (c1) -- (b1);
\draw (c1) -- (d1);
\draw (d1) -- (e1);
\draw[dashed] (a1.west) -- ++(-1.2,0);
\draw[dashed] (e1.east) -- ++(1.2,0);

% Middle text: permutation arrow
\node[draw=none, align=center] (permtext) at (3,-1.2) 
    {$(\ldots,\textbf{a},\textbf{b},\textbf{c},\textbf{d},\textbf{e},\ldots) \rightarrow (\ldots,\textbf{a},\textbf{c},\textbf{d},\textbf{b},\textbf{e},\ldots)$};

% Optional arc for swap visual (b,c,d)
\draw[->, thick, bend left=50] (0.80,-1) to (1.8,-1);

% Bottom Graph
\node (a2) at (0,-3.5) {a};
\node (c2) at (2,-3.5) {c};
\node (d2) at (4.5,-3.5) {d};
\node (b2) at (3.5,-2) {b};
\node (e2) at (6,-2) {e};

\draw (a2) -- (c2);
\draw (c2) -- (d2);
\draw (d2) -- (b2);
\draw (b2) -- (e2);
\draw[dashed] (a2.west) -- ++(-1.2,0);
\draw[dashed] (e2.east) -- ++(1.2,0);

\end{tikzpicture}

    }
    \caption{Illustration of node relocation.}
    \label{fig:perm-swap}
\end{figure}

\subsection{Scalable Local Search}
Local search, particularly the 2-opt heuristic, is highly effective for improving ACO-generated solutions but is often applied sparingly due to its computational cost.

To enable frequent refinement, our algorithm incorporates two optimizations from \cite{FACO2022}. First, it tracks modified edges in each constructed tour and applies 2-opt only to those differing from the previously optimized tour. Second, it restricts 2-opt to candidate edges, thereby reducing the search space.

With a constant-size candidate list and a limited set of modified edges, this optimized 2-opt can be applied to every solution efficiently, fully exploiting high-quality tours without prohibitive overhead.

\begin{figure*}[!htb]
  \centering
  % \includegraphics[width=\textwidth]{two col.png}

  \resizebox{\textwidth}{!}{%
\begin{tabular}{l cc cc cc}
\toprule[1pt]
& \multicolumn{2}{c}{TSPLib200} & \multicolumn{2}{c}{TSPLib500} & \multicolumn{2}{c}{TSPLib1000} \\
\cmidrule(lr){2-3}\cmidrule(lr){4-5}\cmidrule(lr){6-7}
Method & Gap(\%) & Time & Gap(\%) & Time & Gap(\%) & Time \\
\midrule[1pt]
DeepACO    & 1.50 & 13.70s  & 3.43 & 143.92s  & 4.86 & 1047.59s \\
GFACS      & 1.44 & 13.75s  & 2.46 & 150.49s  & 3.99 & 1141.24s \\
NeuFACO    & \textbf{1.39} & \textbf{0.22s}  & \textbf{2.06} & \textbf{0.48s}  & \textbf{2.98} & \textbf{1.03s} \\
\bottomrule[1pt]
\end{tabular}
\hfill
\begin{tabular}{l cc cc cc}
\toprule[1pt]
& \multicolumn{2}{c}{TSP200} & \multicolumn{2}{c}{TSP500} & \multicolumn{2}{c}{TSP1000} \\
\cmidrule(lr){2-3}\cmidrule(lr){4-5}\cmidrule(lr){6-7}
Method & Gap(\%) & Time & Gap(\%) & Time & Gap(\%) & Time \\
\midrule[1pt]
DeepACO    & 1.89 & 16.86s  & 3.03 & 119.58s  & 4.32 & 659.43s \\
GFACS      & 1.80 & 17.36s  & 1.54 & 136.14s  & 2.48 & 730.56s \\
NeuFACO    & \textbf{1.66} & \textbf{0.28s}  & \textbf{1.50} & \textbf{0.74s}  & \textbf{2.00} & \textbf{1.98s} \\
\bottomrule[1pt]
\end{tabular}
  }

  \caption{Different prior comparison.}
  \label{fig:NAR}
\end{figure*}

\section{Experiments}
\hypersetup{citecolor=blue}
This section presents experimental results to validate the effectiveness of our algorithm. We compare it against other ACO-based methods as well as state-of-the-art neural approaches for solving the TSP. Our source code is built upon codebases of previous ACO-based methods: DeepACO (NeurIPS 2023) \cite{DeepACO} and GFACS (ATSTATS 2025) \cite{GFACS}; code is publicly available on GitHub\footnote{\url{https://github.com/shoraaa/NeuFACO}}.

\subsection{Setup}

\subsubsection{Training}
We train and evaluate NeuFACO against two baseline models, DeepACO and GFACS. NeuFACO is trained with 30 ants, 20 PPO steps per epoch, a batch size of 20, a learning rate of 0.001, a clip ratio of 0.2, and an entropy coefficient of 0.01. All experiments are conducted on a machine with an AMD RX6800 GPU and an Intel i5-13400 CPU at \SI{2.50}{GHz}. For fair comparison, DeepACO and GFACS are re-trained using their originally reported parameters, with the sole adjustment being the number of epochs, aligned to ours. Figure~\ref{fig:val} presents the model sampling cost over training steps on the validation and test datasets, respectively.

\subsubsection{Benchmark}
We evaluate NeuFACO on two benchmark datasets: randomized TSP instances with size 200, 500 and 1000, each with 128 instances \cite{DeepACO}, and TSPLib \cite{tsplib} with up to 1500 nodes. Each experiment is repeated $R=10$ times, and results are reported as averages. For other baseline methods, results are taken directly from their respective papers. Errors are computed as $E=(\text{cost}-\text{optimal}) / \text{cost}\times100\%$. The optimal values for gap calculation are obtained using an exact solver.


\begin{figure}[htbp]
  \centering
  \includegraphics[width=\linewidth]{TSP200_TSP500_Test.pdf}
  \caption{Test objective cost over training step.}
  \label{fig:val}
\end{figure}



\subsection{Comparison with other NAR solvers}
We compare NeuFACO with previously proposed non-autoregressive methods, DeepACO and GFACS, both of which outperform the classical ACO without neural guidance \cite{DeepACO,GFACS}. For all compared NAR models, the number of ants is fixed at $M=100$, and each run consists of $I=100$ ACO iterations. Unlike these methods, which employ neural-guided perturbation, NeuFACO does not rely on this technique; instead, it applies scalable local search at every iteration, providing effective refinement without additional perturbation mechanisms.

\begin{figure}[!b]
  \centering
  \includegraphics[width=\linewidth]{TSPOverview.pdf}
  \caption{Minimum, maximum and average errors comparison.}
  \label{fig:candle}
\end{figure}

Figure~\ref{fig:NAR} shows that among DeepACO, GFACS, and NeuFACO, our model achieves the best solution quality across nearly all datasets. NeuFACO delivers these improvements with a 5--100$\times$ runtime reduction relative to prior methods, primarily due to the refined sampler that leverages neural heuristics while incurring minimal quality loss. Moreover, the use of PPO with entropy regularization alleviates policy degradation, ensuring solution quality on par with or superior to existing models. The gains are particularly pronounced on large-scale instances, such as TSPLib graphs with up to 1500 nodes, demonstrating NeuFACO’s suitability for efficiently solving large TSP instances without sacrificing accuracy.

Figure~\ref{fig:over_iterations} further illustrates the evolution of average objective costs over iterations, confirming NeuFACO’s rapid convergence compared to other baselines.


\begin{figure}[!tb]
  \centering
  \includegraphics[width=\linewidth]{TSP200_vs_TSP500_3lines.pdf}
  \caption{Objective cost over iterations between different priors.}
  \label{fig:over_iterations}
\end{figure}

\subsection{Comparison with other RL solvers}
In this section, we present experimental results comparing NeuFACO with problem-specific RL approaches for the TSP. Baselines include RL-based constructive methods (AM \cite{am}, POMO \cite{pomo}, SymNCO \cite{symaco}, Pointerformer \cite{pointerformer}), heatmap-based DIMES \cite{dimes}, improvement-based SO (Select-and-Optimize) \cite{SelectAndOptimize}, and enhanced POMO variants using EAS and SGBS.

% \begin{figure}[!tb]
%   \centering
%   \includegraphics[width=\linewidth]{rlsolvers.png}
%   \caption{Comparison with RL-based solvers (placeholder).}
%   \label{fig:rlsolvers}
% \end{figure}

\begin{figure}[!tb]
\centering
\footnotesize
\setlength{\tabcolsep}{2pt}
\renewcommand{\arraystretch}{1.2}

\begin{minipage}[t]{\linewidth}
\vspace*{0pt}
\centering
\begin{tabular}{l ccc ccc}
\toprule[1pt]
& \multicolumn{3}{c}{TSP500} & \multicolumn{3}{c}{TSP1000}\\
\cmidrule(lr){2-4}\cmidrule(lr){5-7}
Method & Obj. & Gap(\%) & Time & Obj. & Gap(\%) & Time \\
\midrule[1pt]
Concorde           & 16.55 & --    & 10.7s & 23.12 & --   & 108s \\
LKH-3              & 16.55 & 0.02  & 31.7s & 23.14 & 0.10 & 102s \\
\cmidrule(lr){1-1}\cmidrule(lr){2-4}\cmidrule(lr){5-7}
AM                 & 21.46 & 29.07 & 0.6s & 33.55 & 45.10 & 1.5s \\
POMO               & 20.57 & 24.40 & 0.6s & 32.90 & 42.30 & 4.1s \\
\quad +EAS         & 18.25 & 10.29 & 300s & 30.77 & 33.06 & 600s \\
\quad +SGBS        & 18.86 & 13.98 & 318s & 28.58 & 23.61 & 605s \\
DIMES              & 17.01 & 2.78  & 11s  & 24.45 & 5.75  & 32s \\
SO                 & 16.94 & 2.40  & 15s  & 23.77 & 2.80  & 26s \\
Pointerformer      & 17.14 & 3.56  & 14s  & 24.80 & 7.90  & 40s \\
\cmidrule(lr){1-1}\cmidrule(lr){2-4}\cmidrule(lr){5-7}
ACO                & 17.38 & 5.04 & \textbf{14s} & 24.76 & 7.09 & 57s \\
DeepACO            & 16.84 & 1.77 & 15s & 23.78 & 2.87 & 66s \\
GFACS              & 16.80 & 1.56 & 15s & 23.72 & 2.63 & 66s \\
NeuFACO            & \textbf{16.43} & \textbf{1.33} & 15.9s
                   & \textbf{23.34} & \textbf{1.16} & \textbf{41s} \\
\bottomrule[1pt]
\end{tabular}
\end{minipage}

\caption{Performance comparison on TSP500 and TSP1000 instances.}
\label{fig:tsp-results}
\end{figure}


Results show that NeuFACO consistently delivers superior or highly competitive performance against all baselines. It outperforms fast zero-shot methods such as AM and POMO, even with search enhancements like EAS or SGBS, and surpasses similarly paced approaches including DIMES and Pointerformer.

\section{Conclusion}
In conclusion, NeuFACO integrates deep reinforcement learning with a refined ACO framework to address limitations of non-autoregressive models for the TSP. By combining PPO-based policy learning with targeted refinement around high-quality solutions, it achieves a strong balance between global guidance and local exploitation. This synergy preserves solution structure, accelerates convergence, and scales effectively to large instances. Experiments show NeuFACO consistently outperforms state-of-the-art RL neural baselines on both randomized and benchmark datasets, highlighting the effectiveness of PPO-guided priors in enhancing ACO. Overall, NeuFACO provides a robust and generalizable framework for neural-augmented combinatorial optimization.

\section*{Acknowledgment}
The authors would like to thank contributors of prior codebases and reviewers for helpful comments.

\bibliographystyle{IEEEtran}
\bibliography{refs}

\end{document}
